var Polling=require("./polling");var qs=require("querystring");module.exports=JSONP;function JSONP(a){Polling.call(this,a);this.head="___eio["+(a._query.j||"").replace(/[^0-9]/g,"")+"](";this.foot=");"}JSONP.prototype.__proto__=Polling.prototype;JSONP.prototype.onData=function(a){a=qs.parse(a).d;if("string"==typeof a){Polling.prototype.onData.call(this,a.replace(/\\n/g,"\n"))}};JSONP.prototype.doWrite=function(b){var c=JSON.stringify(b).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029");b=this.head+c+this.foot;var d={"Content-Type":"text/javascript; charset=UTF-8","Content-Length":Buffer.byteLength(b)};var a=this.req.headers["user-agent"];if(a&&(~a.indexOf(";MSIE")||~a.indexOf("Trident/"))){d["X-XSS-Protection"]="0"}this.res.writeHead(200,this.headers(this.req,d));this.res.end(b)};JSONP.prototype.headers=function(a,b){b=b||{};if(/MSIE 8\.0/.test(a.headers["user-agent"])){b["X-XSS-Protection"]="0"}this.emit("headers",b);return b};